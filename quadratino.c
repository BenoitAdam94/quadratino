//        QUADRATINO
//    a (shitty) Snake clone for Game Boy


// ## INCLUDES ##
#include <gb/gb.h>
#include <gb/hardware.h>
#include <rand.h>

/* 

[TODO]
- Bonus Food GFX
- Smoother control system (2 counters?)
- Random generator Routine
- Avoid spawning food and bonus on the snake
- Game Over screen
- Select Mode and difficulty on Start Screen
- Frame/Frameless Mode
- Decent tail System

*/

// ## FUNCTIONS ##
void drawFrame();
void fadeOutBkg(UINT8);
void fadeInBkg(UINT8);
void spawnHead();
void spawnFood();
void spawnBonus();
void killBonus();
void checkMargins();
void printScore(UINT16);
void clearNumbers();
void moveHead();
void VBLwait();
void updateInputBuffer();
void gameOver();
void stopSFX();
void playSFX(UINT8);
void clearBKG();
UINT16 mapCoordinate(UINT8, UINT8);
UINT8 randomize(UINT8,UINT8);

// ## CONSTANTS ##
#define movrate 8
#define VBLwaitqty 0
#define bonusrate 3
#define timeToLive 75
#define sfoodValue 1
#define sbonusValue 5
#define sbaseValue 1

// ## SPRITES AND TILE MAPS ##
const unsigned char game_over_map_data[] ={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x02,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x03,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x00,0x0E,0x0F,0x10,0x0C,0x0C,0x0D,
  0x0C,0x11,0x12,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x05,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x00,0x1B,0x1C,0x1D,0x1E,0x19,0x1A,
  0x19,0x1F,0x12,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x20,0x21,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x03,0x22,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x3F,0x40,0x3D,0x41,0x42,0x43,
  0x44,0x45,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x46,0x47,0x48,0x49,0x4A,0x4B,0x4C,0x4D,0x4E,0x4F,0x50,0x51,0x52,0x53,
  0x54,0x55,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const unsigned char game_over_tile_data[] ={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x80,0x80,0x80,0x80,0x80,0x80,
  0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x80,0x80,0x83,0x83,0x83,0x83,0x8F,0x8F,0x8F,0x8F,0x8F,0x8F,0x8F,0x8F,0x8F,0x8F,
  0x00,0x00,0xFC,0xFC,0xFC,0xFC,0x0F,0x0F,0x0F,0x0F,0x00,0x00,0x00,0x00,0x3F,0x3F,
  0x00,0x00,0x03,0x03,0x03,0x03,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0F,0x0F,
  0x00,0x00,0xFC,0xFC,0xFC,0xFC,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0xFF,0xFF,
  0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0C,0x0C,
  0x00,0x00,0x0F,0x0F,0x0F,0x0F,0x3F,0x3F,0x3F,0x3F,0xFF,0xFF,0xFF,0xFF,0xCF,0xCF,
  0x00,0x00,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,
  0x00,0x00,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0x00,0x00,
  0x00,0x00,0x03,0x03,0x03,0x03,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,
  0x00,0x00,0xFC,0xFC,0xFC,0xFC,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,
  0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
  0x00,0x00,0xFC,0xFC,0xFC,0xFC,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0xFC,0xFC,
  0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,
  0x8F,0x8F,0x8F,0x8F,0x8F,0x8F,0x83,0x83,0x83,0x83,0x80,0x80,0x80,0x80,0x80,0x80,
  0x3F,0x3F,0x0F,0x0F,0x0F,0x0F,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0F,0x0F,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,
  0xFF,0xFF,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,
  0xCF,0xCF,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0C,0x0C,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0F,0x0F,0x3C,0x3C,0x3C,0x3C,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,
  0xFC,0xFC,0x30,0x30,0x30,0x30,0x0F,0x0F,0x0F,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x00,
  0x80,0x80,0x80,0x80,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0E,0x0E,0x0E,0x0E,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,
  0x3F,0x3F,0x70,0x70,0x7F,0x7F,0x3F,0x3F,0x07,0x07,0x47,0x47,0x47,0x47,0x3F,0x3F,
  0x07,0x07,0x0E,0x0E,0x0E,0x0E,0x0E,0x0E,0x8E,0x8E,0x8E,0x8E,0x8E,0x8E,0x07,0x07,
  0xE0,0xE0,0x71,0x71,0x71,0x71,0x01,0x01,0x01,0x01,0x71,0x71,0x71,0x71,0xE0,0xE0,
  0xFC,0xFC,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,0xFC,0xFC,
  0x3F,0x3F,0x39,0x39,0x39,0x39,0x39,0x39,0x3F,0x3F,0x3B,0x3B,0x3B,0x3B,0x39,0x39,
  0x87,0x87,0xC7,0xC7,0xC7,0xC7,0xC7,0xC7,0x87,0x87,0x07,0x07,0x07,0x07,0xC7,0xC7,
  0xF8,0xF8,0x00,0x00,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xF8,
  0x00,0x00,0x70,0x70,0x70,0x70,0x70,0x70,0x00,0x00,0x70,0x70,0x70,0x70,0x70,0x70,
  0x00,0x00,0x1F,0x1F,0x27,0x27,0x27,0x27,0x27,0x27,0x3F,0x3F,0x27,0x27,0x27,0x27,
  0x00,0x00,0x00,0x00,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x80,0x80,0x8C,0x8C,0x8C,0x8C,
  0x00,0x00,0x0F,0x0F,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x00,0x00,0xE7,0xE7,0x86,0x86,0x86,0x86,0x86,0x86,0x87,0x87,0x86,0x86,0x86,0x86,
  0x00,0x00,0xE3,0xE3,0x73,0x73,0x73,0x73,0x71,0x71,0xE0,0xE0,0xC0,0xC0,0x70,0x70,
  0x00,0x00,0x38,0x38,0x38,0x38,0xF8,0xF8,0xF0,0xF0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,
  0x00,0x00,0x07,0x07,0x09,0x09,0x09,0x09,0x09,0x09,0x0F,0x0F,0x09,0x09,0x09,0x09,
  0x00,0x00,0xC3,0xC3,0xE6,0xE6,0xE6,0xE6,0xE6,0xE6,0xE6,0xE6,0xE6,0xE6,0xE3,0xE3,
  0x00,0x00,0xE1,0xE1,0x72,0x72,0x72,0x72,0x02,0x02,0xF3,0xF3,0x72,0x72,0xF2,0xF2,
  0x00,0x00,0xF0,0xF0,0x78,0x78,0x78,0x78,0x78,0x78,0xF8,0xF8,0x78,0x78,0x78,0x78,
  0x00,0x00,0xF8,0xF8,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0xF8,0xF8,
  0x00,0x00,0x8E,0x8E,0xCE,0xCE,0xEE,0xEE,0xEE,0xEE,0xBE,0xBE,0x9E,0x9E,0x8E,0x8E,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x33,0x33,0x3F,0x3F,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x8C,0x8C,0x8C,0x8C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x0C,0x0C,0x0F,0x0F,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC7,0xC7,0x01,0x01,0xC1,0xC1,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF1,0xF1,0xC2,0xC2,0xC2,0xC2,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF1,0xF1,0x79,0x79,0x79,0x79,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xF8,0x9C,0x9C,0x9C,0x9C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,0x38,0x38,0x38,0x38,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x03,0x03,0x03,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0x01,0x01,0xF1,0xF1,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFC,0xCE,0xCE,0xCE,0xCE,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x60,0x60,0x7E,0x7E,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x30,0x30,0x3F,0x3F,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x91,0x91,0x19,0x19,0x1D,0x1D,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
  0x3F,0x3F,0x33,0x33,0x33,0x33,0x3F,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0C,0x0C,0x80,0x80,0x8C,0x8C,0x0C,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x07,0x07,0x01,0x01,0x09,0x09,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xC1,0xC1,0xE1,0xE1,0xE1,0xE1,0xC1,0xC1,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xC2,0xC2,0xC3,0xC3,0xC2,0xC2,0xC2,0xC2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x79,0x79,0xF9,0xF9,0x79,0x79,0x79,0x79,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x9C,0x9C,0xF8,0xF8,0xB0,0xB0,0x9C,0x9C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x00,0x00,0x02,0x02,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xF1,0xF1,0x79,0x79,0x79,0x79,0xF0,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x80,0x80,0x80,0x80,0x9C,0x9C,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xCE,0xCE,0xFC,0xFC,0xD8,0xD8,0xCE,0xCE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x7E,0x7E,0x60,0x60,0x60,0x60,0x7F,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x3F,0x3F,0x30,0x30,0x30,0x30,0x3F,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x1D,0x1D,0x17,0x17,0x13,0x13,0x91,0x91,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const unsigned char splash_map[] ={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
  0x0D,0x0D,0x0D,0x0D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x13,0x15,0x16,0x12,0x13,0x17,0x18,0x19,0x1A,
  0x1B,0x11,0x0E,0x16,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x1C,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x24,0x25,0x20,0x21,0x26,0x27,0x28,0x29,
  0x2A,0x2B,0x1C,0x2C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,0x2D,
  0x2D,0x2D,0x2D,0x2D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x2E,0x2F,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x31,0x3A,
  0x3B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x3C,0x3D,0x3E,0x3F,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,
  0x4A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const unsigned char splash_tile[] ={  
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x07,0x07,0x09,0x09,0x09,0x09,0x0F,0x0F,0x09,0x09,0x09,0x09,
  0x00,0x00,0x00,0x00,0x88,0x88,0xC8,0xC8,0xC8,0xC8,0xC8,0xC8,0xC5,0xC5,0xC3,0xC3,
  0x00,0x00,0x00,0x00,0xC7,0xC7,0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0x83,0x83,0x07,0x07,
  0x00,0x00,0x00,0x00,0x88,0x88,0x08,0x08,0x08,0x08,0x08,0x08,0x05,0x05,0x83,0x83,
  0x00,0x00,0x00,0x00,0xC7,0xC7,0xC9,0xC9,0xC9,0xC9,0xCF,0xCF,0x89,0x89,0x09,0x09,
  0x00,0x00,0x00,0x00,0x87,0x87,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xC7,0xC7,
  0x00,0x00,0x00,0x00,0x8F,0x8F,0xCC,0xCC,0x0F,0x0F,0x0C,0x0C,0xCC,0xCC,0x8F,0x8F,
  0x00,0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0xC0,0xC0,
  0x00,0x00,0x00,0x00,0x78,0x78,0x9C,0x9C,0x1C,0x1C,0x78,0x78,0xE0,0xE0,0xFC,0xFC,
  0x00,0x00,0x00,0x00,0x78,0x78,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0x78,0x78,
  0x00,0x00,0x00,0x00,0x30,0x30,0x70,0x70,0x30,0x30,0x30,0x30,0x30,0x30,0x78,0x78,
  0x00,0x00,0x00,0x00,0xF8,0xF8,0xC0,0xC0,0xF8,0xF8,0x1C,0x1C,0x9C,0x9C,0x78,0x78,
  0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0x0F,0x0F,0x3C,0x3C,0x3C,0x3C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0xF0,0xF0,0x0C,0x0C,0x0C,0x0C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0x0F,0x0F,0x30,0x30,0x30,0x30,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0xF0,0xF0,0xFC,0xFC,0xFC,0xFC,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x3F,0x3F,0x30,0x30,0x30,0x30,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x3F,0x3F,0x3C,0x3C,0x3C,0x3C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0xF0,0xF0,0x3C,0x3C,0x3C,0x3C,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x3F,0x3F,0x03,0x03,0x03,0x03,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xC0,0xC0,0xC0,0xC0,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0x0F,0x0F,0x03,0x03,0x03,0x03,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0xF0,0xF0,0xC0,0xC0,0xC0,0xC0,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x30,0x30,0x3C,0x3C,0x3C,0x3C,
  0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x0F,0x0F,0x0F,0x0F,
  0x0C,0x0C,0x0C,0x0C,0xCC,0xCC,0xCC,0xCC,0x30,0x30,0x30,0x30,0xCC,0xCC,0xCC,0xCC,
  0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,0x0F,0x0F,
  0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0xFC,0xFC,0xFC,0xFC,0xF0,0xF0,0xF0,0xF0,
  0x30,0x30,0x30,0x30,0x3F,0x3F,0x3F,0x3F,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
  0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
  0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x3F,0x3F,0x3F,0x3F,
  0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xF0,0xF0,0xF0,0xF0,
  0x3C,0x3C,0x3C,0x3C,0x3F,0x3F,0x3F,0x3F,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,
  0x3C,0x3C,0x3C,0x3C,0xF0,0xF0,0xF0,0xF0,0xC0,0xC0,0xC0,0xC0,0x3C,0x3C,0x3C,0x3C,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x0F,0x0F,0x0F,0x0F,
  0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xF0,0xF0,0xF0,0xF0,
  0x3F,0x3F,0x3F,0x3F,0x33,0x33,0x33,0x33,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
  0x3C,0x3C,0x3C,0x3C,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x3C,0x3C,0x3C,0x3C,
  0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0x3C,0xF0,0xF0,0xF0,0xF0,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFC,0xCE,0xCE,0xCE,0xCE,0xCE,0xCE,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x39,0x39,0x39,0x39,0x39,0x39,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x87,0x87,0xC7,0xC7,0xC7,0xC7,0xC7,0xC7,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xF8,0x00,0x00,0xF0,0xF0,0xF0,0xF0,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7E,0x7E,0xE0,0xE0,0xFE,0xFE,0x7E,0x7E,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0x1C,0x1C,0x1F,0x1F,0x0F,0x0F,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0xC0,0xC0,0xC0,0xC0,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x0E,0x0E,0x0F,0x0F,0x07,0x07,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE1,0xE1,0x00,0x00,0xE0,0xE0,0xE0,0xE0,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,0x38,0x38,0x38,0x38,0x38,0x38,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0x1F,0x23,0x23,0x23,0x23,0x23,0x23,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0x38,0x38,0x38,0x38,0x38,0x38,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xFC,0xFC,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x3F,0x3F,0x3B,0x3B,0x3B,0x3B,0x39,0x39,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x87,0x87,0x07,0x07,0x07,0x07,0xC7,0xC7,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x0F,0x0F,0x8F,0x8F,0x8F,0x8F,0x7E,0x7E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x11,0x11,0x11,0x11,0x0F,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x08,0x08,0x08,0x08,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xE0,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x3F,0x3F,0x23,0x23,0x23,0x23,0x23,0x23,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xC7,0xC7,0xC7,0xC7,0xC7,0xC7,0xC7,0xC7,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xF0,0xF0,0x60,0x60,0x60,0x60,0x38,0x38,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const unsigned char game_sprites[] = 
	{
	// Tile 0
	  0x00,0x00,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x00,0x00,
	// Tile 1
	  0x00,0x00,0x00,0x18,0x00,0x18,0x00,0x66,0x00,0x66,0x00,0x18,0x00,0x18,0x00,0x00,
	// Tile 2
	  0x00,0x00,0x00,0x66,0x00,0x66,0x00,0x18,0x00,0x18,0x00,0x66,0x00,0x66,0x00,0x00,
	// Tile 3
    0x00,0x00,0x00,0x7E,0x00,0x7E,0x00,0x7E,0x00,0x7E,0x00,0x7E,0x00,0x7E,0x00,0x00,
	// Tile 4-13
  	0x00,0x00,0x3C,0x3C,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x3C,0x3C,0x00,0x00,
  	0x00,0x00,0x18,0x18,0x38,0x38,0x18,0x18,0x18,0x18,0x18,0x18,0x3C,0x3C,0x00,0x00,
  	0x00,0x00,0x3C,0x3C,0x4E,0x4E,0x0E,0x0E,0x3C,0x3C,0x70,0x70,0x7E,0x7E,0x00,0x00,
  	0x00,0x00,0x7C,0x7C,0x0E,0x0E,0x3C,0x3C,0x0E,0x0E,0x0E,0x0E,0x7C,0x7C,0x00,0x00,
  	0x00,0x00,0x3C,0x3C,0x6C,0x6C,0x4C,0x4C,0x4C,0x4C,0x7E,0x7E,0x0C,0x0C,0x00,0x00,
  	0x00,0x00,0x7C,0x7C,0x60,0x60,0x7C,0x7C,0x0E,0x0E,0x4E,0x4E,0x3C,0x3C,0x00,0x00,
  	0x00,0x00,0x3C,0x3C,0x60,0x60,0x7C,0x7C,0x66,0x66,0x66,0x66,0x3C,0x3C,0x00,0x00,
  	0x00,0x00,0x7E,0x7E,0x06,0x06,0x0C,0x0C,0x18,0x18,0x38,0x38,0x38,0x38,0x00,0x00,
  	0x00,0x00,0x3C,0x3C,0x4E,0x4E,0x3C,0x3C,0x4E,0x4E,0x4E,0x4E,0x3C,0x3C,0x00,0x00,
  	0x00,0x00,0x3C,0x3C,0x4E,0x4E,0x4E,0x4E,0x3E,0x3E,0x0E,0x0E,0x3C,0x3C,0x00,0x00
  	// Tile 14
};	

unsigned char tail_map_data[] ={
  0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const unsigned char tail_tile_data[] ={
  0x00,0x00,0x7E,0x7E,0x42,0x7E,0x42,0x7E,0x42,0x7E,0x42,0x7E,0x7E,0x7E,0x00,0x00,  // Tile 0x00
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // Tile 0x01
  0x00,0x00,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x7E,0x00,0x00,  // Tile 0x02
  // tail_tail_data[0x02] is actually a copy of tail_tail_data[0x00] used to avoid flickering behind the head. (Not triggering collisions)
};

// ## VARIABLES ##
UBYTE justStarted,soundStart,s,k,bonus_score,food_score,digit1,tail_x,tail_y,life,justBonused,bonus_x,bonus_y,foodRedraw,counter,head_x,head_y,food_x,food_y,last,lastb,respawnFood,food_xr,food_yr,valid, initialFoodSpawn, initialHeadSpawn,buffer[20],tail[100][3],i,p;
UINT16 digit[3],x,y,score,pos,j,frame,estimate;
UWORD seed;

// ## DO THINGS ##
int main(){
  start:		// point of start after losing (or first run)
  clearBKG();

  // Init values
  k=1;
  last=3;
  lastb=3;
  justStarted=1;

  // Load resources for start screen
  disable_interrupts();
  DISPLAY_OFF;
  SPRITES_8x8;
  set_sprite_data(0, 30, game_sprites);
  for (i=0;i<3;i++) set_sprite_tile(i,i);
  set_bkg_data(0,168,splash_tile);
  set_bkg_tiles(0,0,32,32,splash_map);
  
  // set up Sound
  NR52_REG = 0x8F;	// TURN SOUND ON
  NR51_REG = 0xff;	// play sfx on Channel 1
  NR50_REG = 0x20; 	// Volume (MAX = 0x77, min = 0x00)

  DISPLAY_ON;
  enable_interrupts();

  // START SCREEN
  fadeInBkg(255);
  waitpad(0x80);         // get a decent seed
  fadeOutBkg(255);
  SHOW_SPRITES; 

  // GAME SCREEN
  seed |= (UWORD)DIV_REG << 8;  // Init rand seed
  initrand(seed); // Divider Register shifted

  // Initial spawns
  spawnHead();
  spawnFood();

	// SET UP game BKG 
  set_bkg_data(0,168,tail_tile_data);
  set_bkg_tiles(0,0,32,32,tail_map_data);
  fadeInBkg(1);

  // Move Scoreboard sprites
  move_sprite(7,143,16);
  move_sprite(8,151,16);
  move_sprite(9,159,16);

  drawFrame();  // The frame, some manual drawing..

  // We're in!
  while(1) {    //  Main Game Flow
    VBLwait();  // Skips some VBlank
  	
    //		  ------------------------
	  //         START OF DRAW TAIL
    //      ------------------------ 

	  //  Are we really clearing everything and redrawing every single tail part in the BKG every frame?
    //  Ye, that's embarassing

    //  tail[i][0] is X, tail[i][1] is Y, tail[i][2] is the orientation

    //  [TODO] Define a decent ClearBKG(pointA_x,pointA_y,pointB_x,pointB_y)
    //  for (j=0;j<564; j++) tail_map_data[j]=0x01; Old ClearBKG routine
    
    for (j=1;j<17; j++) {             // Clean up all BKG but the frame
      for (p=1;p<19;p++)  {
        tail_map_data[j*32+p]=0x01;
      }
    }
    
    tail[0][0]=head_x;              //  Load Head parameters into tail[0]
    tail[0][1]=head_y;
    tail[0][2]=last;

    for(i=1;i<food_score+1;i++){    // Food_score+1 is the snake length
      if(tail[i-1][2]==1) {         // Every tail is the Head for the following part. . 
        tail[i][0]=tail[i-1][0];
        tail[i][1]=tail[i-1][1]+movrate; 
      }
      if(tail[i-1][2]==2) {
        tail[i][0]=tail[i-1][0];
        tail[i][1]=tail[i-1][1]-movrate; 
      }
      if(tail[i-1][2]==3) {
        tail[i][0]=(tail[i-1][0]+movrate); 
        tail[i][1]=(tail[i-1][1]);
      }
      if(tail[i-1][2]==4) {
        tail[i][0]=(tail[i-1][0]-movrate); 
        tail[i][1]=(tail[i-1][1]);
      }

      x=(tail[i][0]-8)/8;             //  Convert absolute coordinates to pseudo-relative
      y=(tail[i][1]-16)/8;            
      tail_map_data[y*32+x]=0x00;     //  Convert pseudo-relative coordinates into tile absolute sequence-number and draw it
    }

    //if (food_score>0){              //  Silently draw a tile sprite to void flickering behind head
        x=(tail[0][0]-8)/8;            
        y=(tail[0][1]-16)/8; 
        tail_map_data[y*32+x]=0x02;    
      //} 

    for (i=food_score+1;i>0;i--)    //	Recalculate orientations of every tail part
        tail[i][2]=tail[i-1][2];
    // tail_map_data[mapCoordinate(tail[1][0],tail[1][1])]=0x00;
    set_bkg_tiles(0,0,32,32,tail_map_data);   //Update BKG

    /*  -----------------------
           END OF DRAW TAIL
        -----------------------   */

    // Game-Tick updates
    life--;    // We need the bonus to die
   	frame++;	// Increase frame counter
	  score = sbaseValue*(food_score*sfoodValue+bonus_score*sbonusValue); // Update total score [!]
	  printScore(score); // Print Score [!]
	  counter = joypad();
    if (life==0) killBonus();   //Time's up for bonus!

	  // Change Direction
    if (head_x%8==0 && head_y%8==0) {   // apply change direction when aligned in grid
    	if(((last==1 || last==2) && (lastb==3 || lastb==4)) || ((last==3 || last==4) && (lastb==1 || lastb==2))) {
    last=lastb;                         // AND only when rota is okay with it (1,2>3,4 3,4>1,2)
      		}
    }
    
    updateInputBuffer();
    if(justStarted<1) moveHead();

    // Collision check
    x=(head_x-8)/8;             //  Get Head position
    y=(head_y-16)/8;
    if (tail_map_data[y*32+x]==0x00) {    // Check if is on a block (or itself)
        gameOver();
        goto start;
   	}

	  // checkMargins(); [!] RUN THIS IN FRAMELESS MODE!

	  // Spawn Bonus
	  if (food_score!=0 && food_score%bonusrate==0 && justBonused==0) spawnBonus();

	  // Head-Bonus collisionCheck
	  if ((head_x==bonus_x && head_y==bonus_y)) {
      playSFX(2);
			soundStart=frame;
			killBonus();
      food_score++;     // [!]
			bonus_score++;
	  }

    // Stop any playing sound
	  if ((frame-soundStart)==3) stopSFX();

	  // Head-Food collisionCheck
	  if ((head_x==food_x && head_y==food_y)){
      playSFX(1);
		  justBonused=0;		// Flag to avoid infinite spawns of Bonus
		  food_score++;
		  spawnFood();
		  soundStart=frame;
		}
	}
}


//FUNCTIONS!

void clearBKG(){
  for (j=0;j<564; j++) tail_map_data[j]=0x01; // Clear BKG
}

void playSFX(UINT8 id){ // Some noise
  if (id==1){
    NR21_REG = 0x7F;  
    NR22_REG = 0x7F;
    NR23_REG = (32-1)*16;
    NR24_REG = 0x86;
  }
  if (id==2){
    NR21_REG = 0x7F;
    NR22_REG = 0x7F;
    NR23_REG = (30)*2;
    NR24_REG = 0x86;
  }
}

void stopSFX(){
  NR21_REG = 0x00;    //Silence
  NR22_REG = 0x00;
  NR23_REG = 0x00;
  NR24_REG = 0x00;
}

void updateInputBuffer(){
  if(counter & J_UP) lastb = 1;       // buffer joypad input
  if(counter & J_DOWN) lastb = 2;
  if(counter & J_LEFT) lastb = 3;
  if(counter & J_RIGHT) lastb = 4;
  if(counter) justStarted=0;
}

void VBLwait(){
  for(counter = 0; counter < VBLwaitqty; counter++){
    wait_vbl_done();
  }
}

void moveHead(){
  if(last==1) head_y-=movrate;
  if(last==2) head_y+=movrate;
  if(last==3) head_x-=movrate;
  if(last==4) head_x+=movrate;
  //move_sprite(0,head_x,head_y);
}

void printScore(UINT16 score){
	/*for(i=0,j=10;i<3;i++) { // Divide in digits, digit[0] is the least significant
		
	} */
  estimate = 1;
  if (score>10) estimate = 2;
  if (score>100) estimate = 3;
  for (i=0,j=10;i<estimate;i++,j*=10){
    digit[i]=(score%j)/(j/10);
    set_sprite_tile(9-i,4+digit[i]);

  }

	/*digit[0]=(score%10)/1;
	digit[1]=(score%100)/10;
	digit[2]=(score%1000)/100;
	set_sprite_tile(7,4+digit[2]);
	set_sprite_tile(8,4+digit[1]);
	set_sprite_tile(9,4+digit[0]);*/
}

void printScore_old(UINT8 score){
	for(i=0,j=10;i<3;i++,j*10) digit[i]=(score%j)/(j/10);    // Divide in digits, digit[0] is the least significant
	clearNumbers();
	move_sprite(4+digit[0],60,60);
}

void clearNumbers(){ //deprecated
	for(i=0;i<10;i++){
		move_sprite(4+i,0,0);
	}
}

void fadeOutBkg(UINT8 edelay){
	BGP_REG=0xE4;
	delay(edelay);
	SHOW_BKG;
	BGP_REG=0xA4;
	SHOW_BKG;
	delay(edelay);
	BGP_REG=0x54;
	SHOW_BKG;
	delay(edelay);
	BGP_REG=0x00;
	SHOW_BKG;
	}

void fadeInBkg(UINT8 edelay){
	BGP_REG=0x00;
	delay(edelay);
	SHOW_BKG;
	BGP_REG=0x54;
	SHOW_BKG;
	delay(edelay);
	BGP_REG=0xA4;
	SHOW_BKG;
	delay(edelay);
	BGP_REG=0xE4;
	SHOW_BKG;
	}

void spawnHead(){
	valid=0;
  	head_x=8*12;
  	head_y=8*15;
 	//move_sprite(0,head_x,head_y);
	/*while(valid==0){
		head_x=8*(2+rand()%19);
		head_y=8*(3+rand()%18);
		//lastb=1+rand()%4;
		valid =1;
		if (head_x < 8 || head_x > 8*20 || head_y < 8*2 || head_y > 8*19 || lastb <1 || lastb >4) valid=0;
		}*/
}

void spawnFood(){
  food_x=8*randomize(2,19);
	food_y=8*randomize(3,18);
	move_sprite(1,food_x,food_y);
}

UINT8 randomize(UINT8 range1,UINT8 range2){     // Generate a valid random n so range1=<n=<range2 
  UINT8 n;                                      // I don't really get why we need to do this
  valid=0;
  while(valid==0){
    n=range1+rand()%range2;
    valid=1;
    if (n < range1 || n > range2) valid=0;
  }
  return n;
}

void drawFrame(){
  for (p=0;p<18; p++) tail_map_data[17*32+1+p]=0x00;
  for (j=0;j<17; j++) tail_map_data[j]=0x00;
  for (j=0;j<18; j++) tail_map_data[j*32]=0x00;
  for (j=1;j<18; j++) tail_map_data[j*32+19]=0x00;
}  

void spawnBonus(){
  valid=0;
  while(valid==0){
    bonus_x=8*(2+rand()%19);
    bonus_y=8*(3+rand()%18);
    if (head_x < 8 || head_x > 8*20 || head_y < 8*2 || head_y > 8*19 || lastb <1 || lastb >4) valid=0;
    valid= 1;
  }
	move_sprite(2,bonus_x,bonus_y);
	justBonused=1;
	life=timeToLive;
}

void killBonus(){ // RIP
	bonus_x=0;
	bonus_y=0;
	move_sprite(2,bonus_x,bonus_y);
}

void gameOver(){
  stopSFX();
  for(i=0;i<10;i++) move_sprite(i,0,0);
  food_score=0;
  bonus_score=0;
  head_x=64;
  head_y=64;
  move_sprite(1,0,0);
  move_sprite(0,0,0);
  VBLwait();
  set_bkg_data(0,168,game_over_tile_data);
  set_bkg_tiles(0,0,32,32,game_over_map_data);
  VBLwait();
  move_sprite(7,80,88);
  move_sprite(8,88,88);
  move_sprite(9,96,88);
  waitpad(0x80);
  move_sprite(7,0,0);
  move_sprite(8,0,0);
  move_sprite(9,0,0);
  score=0;
}

void checkMargins(){
	if (head_y<=8)
		head_y=152;
	else if(head_y>=160) 
		head_y=8;
	if (head_x>=168)
		head_x=0;	
	else if(head_x<=0) 
		head_x=160;
}

UINT16 mapCoordinate(UINT8 x, UINT8 y){
  UINT16 n;
  n = (y*32)+x;
  return n;
}



/*
Old routines
---------------------------------------------------------------------------
      0~563
      0,0~17,19
      32 per row
      19 visible per row
      y*32 + x
      
       #---------------------------------->
       |0,0                               
       |
       |
       |
       |
       |
       |
       |
       |
       |
       |
       |
       ↓                                19,17
---------------------------------------------------------------------------
		Working but need 9 gameboys to load the sprites
						 ^^^^^^^^^^ KKKKKEK
		for (i=1;i<food;i++){			//Let's draw the tail

			if(last==1) {
				tail[i][1]=head_y+movrate; 
				tail[i][0]=head_x;
			}
			if(last==2) {
				tail[i][1]=head_y-movrate; 
				tail[i][0]=head_x;
			}
			if(last==3) {
				tail[i][0]=head_x+movrate; 
				tail[i][1]=head_y;
			}
			if(last==4) {
				tail[i][0]=head_x-movrate; 
				tail[i][1]=head_y;
			}
			move_sprite(i+3,tail[i][0],tail[i][1]);
---------------------------------------------------------------------------
}*/